{"tags":[{"name":"学习","permalink":"http://catlittlechen.com/tags/学习/","url":"/async/tags/学习.json","count":12},{"name":"elasticsearch","permalink":"http://catlittlechen.com/tags/elasticsearch/","url":"/async/tags/elasticsearch.json","count":6}],"categories":[{"name":"elasticsearch","permalink":"http://catlittlechen.com/categories/elasticsearch/","url":"/async/categories/elasticsearch.json","count":6}],"url":"/async/posts/2016/08/01/es1.json","date":1470050781000,"path":{"year":2016,"month":8,"day":1,"name":"es1"},"title":"elasticsearch系列笔记(一) 基础知识","permalink":"http://catlittlechen.com/2016/08/01/es1/","content":"<h3 id=\"install\"><a href=\"#install\" class=\"headerlink\" title=\"install\"></a>install</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\">启动docker</div><div class=\"line\">docker run -ti <span class=\"comment\">--name es -p 9200:9200 ubuntu:14.04 /bin/bash</span></div><div class=\"line\"></div><div class=\"line\">更新系统</div><div class=\"line\">apt-get <span class=\"keyword\">update</span></div><div class=\"line\">apt-<span class=\"keyword\">get</span> <span class=\"keyword\">upgrade</span></div><div class=\"line\">apt-<span class=\"keyword\">get</span> <span class=\"keyword\">install</span> software-properties-common</div><div class=\"line\"></div><div class=\"line\">安装<span class=\"keyword\">java</span></div><div class=\"line\"><span class=\"keyword\">add</span>-apt-repository ppa:webupd8team/<span class=\"keyword\">java</span></div><div class=\"line\">apt-<span class=\"keyword\">get</span> <span class=\"keyword\">update</span></div><div class=\"line\">apt-<span class=\"keyword\">get</span> <span class=\"keyword\">install</span> <span class=\"keyword\">oracle</span>-java8-installer</div><div class=\"line\"></div><div class=\"line\">安装es</div><div class=\"line\">wget -qO - https://packages.elastic.co/GPG-<span class=\"keyword\">KEY</span>-elasticsearch | sudo apt-<span class=\"keyword\">key</span> <span class=\"keyword\">add</span> -</div><div class=\"line\">echo <span class=\"string\">\"deb https://packages.elastic.co/elasticsearch/2.x/debian stable main\"</span> &gt;&gt; /etc/apt/sources.list</div><div class=\"line\">apt-<span class=\"keyword\">get</span> <span class=\"keyword\">update</span> &amp;&amp; apt-<span class=\"keyword\">get</span> <span class=\"keyword\">install</span> elasticsearch</div><div class=\"line\"><span class=\"keyword\">update</span>-rc.d elasticsearch <span class=\"keyword\">defaults</span> <span class=\"number\">95</span> <span class=\"number\">10</span></div><div class=\"line\">/etc/init.d/elasticsearch <span class=\"keyword\">start</span></div></pre></td></tr></table></figure>\n<h3 id=\"test\"><a href=\"#test\" class=\"headerlink\" title=\"test\"></a>test</h3><figure class=\"highlight 1c\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -X GET 'http://172.17.0.2:<span class=\"number\">9200</span>'</div></pre></td></tr></table></figure>\n<h3 id=\"install_marvel\"><a href=\"#install_marvel\" class=\"headerlink\" title=\"install marvel\"></a>install marvel</h3><figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta-keyword\">/usr/</span>share<span class=\"meta-keyword\">/elasticsearch/</span>bin/plugin -i elasticsearch<span class=\"meta-keyword\">/marvel/</span>latest</div><div class=\"line\"><span class=\"meta-keyword\">/etc/</span>init.d/elasticsearch restart</div></pre></td></tr></table></figure>\n<h3 id=\"api\"><a href=\"#api\" class=\"headerlink\" title=\"api\"></a>api</h3><figure class=\"highlight rust\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div></pre></td><td class=\"code\"><pre><div class=\"line\">curl -X&lt;VERB&gt; '&lt;PROTOCOL&gt;:<span class=\"comment\">//&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;' -d '&lt;BODY&gt;'</span></div><div class=\"line\">example :</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/_count?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"query\"</span>: &#123;</div><div class=\"line\">                <span class=\"string\">\"match_all\"</span>: &#123;&#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XPUT <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/1?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"first_name\"</span> : <span class=\"string\">\"John\"</span>,</div><div class=\"line\">            <span class=\"string\">\"last_name\"</span> :  <span class=\"string\">\"Smith\"</span>,</div><div class=\"line\">            <span class=\"string\">\"age\"</span> :        <span class=\"number\">25</span>,</div><div class=\"line\">            <span class=\"string\">\"about\"</span> :      <span class=\"string\">\"I love to go rock climbing\"</span>,</div><div class=\"line\">            <span class=\"string\">\"interests\"</span>: [ <span class=\"string\">\"sports\"</span>, <span class=\"string\">\"music\"</span> ]</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/1?pretty'</span></div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty'</span></div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty&amp;q=last_name:Smith'</span></div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"query\"</span>: &#123;</div><div class=\"line\">                <span class=\"string\">\"match\"</span>: &#123;</div><div class=\"line\">                    <span class=\"string\">\"last_name\"</span>: <span class=\"string\">\"Smith\"</span></div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"query\"</span>: &#123;</div><div class=\"line\">                <span class=\"string\">\"filtered\"</span>: &#123;</div><div class=\"line\">                    <span class=\"string\">\"filter\"</span>: &#123;</div><div class=\"line\">                        <span class=\"string\">\"range\"</span>: &#123;</div><div class=\"line\">                            <span class=\"string\">\"age\"</span>: &#123; <span class=\"string\">\"gt\"</span>: <span class=\"number\">20</span> &#125;</div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;,</div><div class=\"line\">                    <span class=\"string\">\"query\"</span>: &#123;</div><div class=\"line\">                        <span class=\"string\">\"match\"</span>: &#123;</div><div class=\"line\">                            <span class=\"string\">\"last_name\"</span>: <span class=\"string\">\"Smith\"</span></div><div class=\"line\">                        &#125;</div><div class=\"line\">                    &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"query\"</span> : &#123;</div><div class=\"line\">                <span class=\"string\">\"match\"</span> : &#123;</div><div class=\"line\">                    <span class=\"string\">\"about\"</span> : <span class=\"string\">\"rock climbing\"</span></div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"query\"</span> : &#123;</div><div class=\"line\">                <span class=\"string\">\"match_phrase\"</span> : &#123;</div><div class=\"line\">                    <span class=\"string\">\"about\"</span> : <span class=\"string\">\"rock climbing\"</span></div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"query\"</span> : &#123;</div><div class=\"line\">                <span class=\"string\">\"match_phrase\"</span> : &#123;</div><div class=\"line\">                    <span class=\"string\">\"about\"</span> : <span class=\"string\">\"rock climbing\"</span></div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;,</div><div class=\"line\">            <span class=\"string\">\"highlight\"</span>: &#123;</div><div class=\"line\">                <span class=\"string\">\"fields\"</span>: &#123;</div><div class=\"line\">                    <span class=\"string\">\"about\"</span>: &#123;&#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div><div class=\"line\">    curl -XGET <span class=\"symbol\">'http</span>:<span class=\"comment\">//172.17.0.2:9200/megacorp/employee/_search?pretty' -d '</span></div><div class=\"line\">        &#123;</div><div class=\"line\">            <span class=\"string\">\"aggs\"</span>: &#123;</div><div class=\"line\">                <span class=\"string\">\"all_interests\"</span>: &#123;</div><div class=\"line\">                    <span class=\"string\">\"terms\"</span>: &#123; <span class=\"string\">\"field\"</span>: <span class=\"string\">\"interests\"</span> &#125;</div><div class=\"line\">                &#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    '</div></pre></td></tr></table></figure>\n"}