{"tags":[{"name":"elasticsearch","permalink":"http://catlittlechen.com/tags/elasticsearch/","url":"/async/tags/elasticsearch.json","count":6},{"name":"学习","permalink":"http://catlittlechen.com/tags/学习/","url":"/async/tags/学习.json","count":6}],"categories":[{"name":"elasticsearch","permalink":"http://catlittlechen.com/categories/elasticsearch/","url":"/async/categories/elasticsearch.json","count":6}],"url":"/async/posts/2016/08/04/es3.json","date":1470312711000,"path":{"year":2016,"month":8,"day":4,"name":"es3"},"title":"elasticsearch系列笔记(三) 基本API","permalink":"http://catlittlechen.com/2016/08/04/es3/","content":"<h4 id=\"u6DFB_u52A0_u6587_u6863_2C_u81EA_u5B9A_u4E49ID\"><a href=\"#u6DFB_u52A0_u6587_u6863_2C_u81EA_u5B9A_u4E49ID\" class=\"headerlink\" title=\"添加文档,自定义ID\"></a>添加文档,自定义ID</h4><pre><code>PUT /{index}/{type}/{id}\n{\n    &quot;field&quot;: &quot;value&quot;,\n}\n</code></pre><h4 id=\"u6DFB_u52A0_u6587_u6863_uFF0C_u8FD9_u65F6_u5019_u7684ID_u662FES_u81EA_u52A8_u751F_u6210_uFF0C_u4E3A22_u4F4D_u7684UUIDS\"><a href=\"#u6DFB_u52A0_u6587_u6863_uFF0C_u8FD9_u65F6_u5019_u7684ID_u662FES_u81EA_u52A8_u751F_u6210_uFF0C_u4E3A22_u4F4D_u7684UUIDS\" class=\"headerlink\" title=\"添加文档，这时候的ID是ES自动生成，为22位的UUIDS\"></a>添加文档，这时候的ID是ES自动生成，为22位的UUIDS</h4><pre><code>POST /{index}/{type}/\n{\n    &quot;field&quot;: &quot;value&quot;,\n}\n</code></pre><h4 id=\"u83B7_u5F97_u6587_u6863\"><a href=\"#u83B7_u5F97_u6587_u6863\" class=\"headerlink\" title=\"获得文档\"></a>获得文档</h4><pre><code>GET /{index}/{type}/{id}?pretty\n{\n    &quot;_index&quot; :   &quot;{index}&quot;,\n    &quot;_type&quot; :    &quot;{type}&quot;,\n    &quot;_id&quot; :      &quot;{id}&quot;,\n    &quot;_version&quot; : 1,\n    &quot;found&quot; :    true, //是否找到，404同步返回\n    &quot;_source&quot; :  {\n        &quot;field&quot;: &quot;value&quot;,\n    }\n}\n</code></pre><h4 id=\"u83B7_u5F97_u6587_u6863_u7684_u7279_u5B9A_u5C5E_u6027\"><a href=\"#u83B7_u5F97_u6587_u6863_u7684_u7279_u5B9A_u5C5E_u6027\" class=\"headerlink\" title=\"获得文档的特定属性\"></a>获得文档的特定属性</h4><pre><code>GET /{index}/{type}/{id}/{key}?pretty\n{\n    &quot;{key}&quot;: &quot;value&quot;\n}\nkey 为上面json的值\n</code></pre><h4 id=\"u83B7_u5F97_u6587_u6863_u7684_u7279_u5B9A_u503C\"><a href=\"#u83B7_u5F97_u6587_u6863_u7684_u7279_u5B9A_u503C\" class=\"headerlink\" title=\"获得文档的特定值\"></a>获得文档的特定值</h4><pre><code>GET /{index}/{type}/{id}?pretty&amp;_source={field1},{field2}\n{\n    &quot;_index&quot; :   &quot;{index}&quot;,\n    &quot;_type&quot; :    &quot;{type}&quot;,\n    &quot;_id&quot; :      &quot;{id}&quot;,\n    &quot;_version&quot; : 1,\n    &quot;found&quot; :    true, //是否找到，404同步返回\n    &quot;_source&quot; :  {\n        &quot;field1&quot;: &quot;value&quot;,\n        &quot;field2&quot;: &quot;value&quot;,\n    }\n}\n</code></pre><h4 id=\"u68C0_u67E5_u6587_u6863_u662F_u5426_u5B58_u5728\"><a href=\"#u68C0_u67E5_u6587_u6863_u662F_u5426_u5B58_u5728\" class=\"headerlink\" title=\"检查文档是否存在\"></a>检查文档是否存在</h4><pre><code>HEAD /{index}/{type}/{id}\n</code></pre><h4 id=\"u66F4_u65B0_u6587_u6863_u7684_u65F6_u5019_uFF0C_u5199_u6CD5_u548C_u63D2_u5165_u65F6_u76F8_u540C\"><a href=\"#u66F4_u65B0_u6587_u6863_u7684_u65F6_u5019_uFF0C_u5199_u6CD5_u548C_u63D2_u5165_u65F6_u76F8_u540C\" class=\"headerlink\" title=\"更新文档的时候，写法和插入时相同\"></a>更新文档的时候，写法和插入时相同</h4><pre><code>_version会递增\n</code></pre><h4 id=\"u521B_u5EFA_u6587_u6863_uFF0C_u6210_u529F_u521B_u5EFA_u7684_u65F6_u5019_uFF0C_u8FD4_u56DE201_uFF0C_u5931_u8D25_u8FD4_u56DE409\"><a href=\"#u521B_u5EFA_u6587_u6863_uFF0C_u6210_u529F_u521B_u5EFA_u7684_u65F6_u5019_uFF0C_u8FD4_u56DE201_uFF0C_u5931_u8D25_u8FD4_u56DE409\" class=\"headerlink\" title=\"创建文档，成功创建的时候，返回201，失败返回409\"></a>创建文档，成功创建的时候，返回201，失败返回409</h4><pre><code>PUT /{index}/{type}/{id}?op_type=create\nPUT /{index}/{type}/{id}/_create\n</code></pre><h4 id=\"u5220_u9664_u6587_u6863_uFF0C_u5931_u8D25_u8FD4_u56DE404\"><a href=\"#u5220_u9664_u6587_u6863_uFF0C_u5931_u8D25_u8FD4_u56DE404\" class=\"headerlink\" title=\"删除文档，失败返回404\"></a>删除文档，失败返回404</h4><pre><code>DELETE /{index}/{type}/{id}\n</code></pre><h4 id=\"u66F4_u65B0_u67D0_u4E2A_u7279_u5B9A_u7248_u672C_u7684_u6587_u6863_uFF0C_u7528_u4E8E_u63A7_u5236_u5E76_u53D1_u9519_u8BEF_uFF0Cversion_type_u8BBE_u7F6E_u4E86_u7528_u6B64_u65F6_u7684version_u6765_u8BBE_u7F6E_u6587_u6863_u7684version\"><a href=\"#u66F4_u65B0_u67D0_u4E2A_u7279_u5B9A_u7248_u672C_u7684_u6587_u6863_uFF0C_u7528_u4E8E_u63A7_u5236_u5E76_u53D1_u9519_u8BEF_uFF0Cversion_type_u8BBE_u7F6E_u4E86_u7528_u6B64_u65F6_u7684version_u6765_u8BBE_u7F6E_u6587_u6863_u7684version\" class=\"headerlink\" title=\"更新某个特定版本的文档，用于控制并发错误，version_type设置了用此时的version来设置文档的version\"></a>更新某个特定版本的文档，用于控制并发错误，version_type设置了用此时的version来设置文档的version</h4><pre><code>PUT /{index}/{type}/{id}?version={version}\nPUT /{index}/{type}/{id}?version={version}&amp;version_type=external\n</code></pre><h4 id=\"u66F4_u65B0_u6587_u6863_u7684_u90E8_u5206_u5185_u5BB9_uFF0C_u5408_u5E76_u6587_u6863\"><a href=\"#u66F4_u65B0_u6587_u6863_u7684_u90E8_u5206_u5185_u5BB9_uFF0C_u5408_u5E76_u6587_u6863\" class=\"headerlink\" title=\"更新文档的部分内容，合并文档\"></a>更新文档的部分内容，合并文档</h4><pre><code>POST /{index}/{type}/{id}/_update\n</code></pre><h4 id=\"u811A_u672C_u662F_u4E00_u4E9B_u5947_u602A_u7684_u903B_u8F91_uFF0C_u4E0D_u8FC7_u86EE_u597D_u73A9_u7684_u3002\"><a href=\"#u811A_u672C_u662F_u4E00_u4E9B_u5947_u602A_u7684_u903B_u8F91_uFF0C_u4E0D_u8FC7_u86EE_u597D_u73A9_u7684_u3002\" class=\"headerlink\" title=\"脚本是一些奇怪的逻辑，不过蛮好玩的。\"></a>脚本是一些奇怪的逻辑，不过蛮好玩的。</h4><h4 id=\"u68C0_u7D22_u591A_u4E2A_u6587_u6863\"><a href=\"#u68C0_u7D22_u591A_u4E2A_u6587_u6863\" class=\"headerlink\" title=\"检索多个文档\"></a>检索多个文档</h4><pre><code>POST /_mget\n{\n    &quot;docs&quot;: [\n        {\n            *******\n        }\n    ]\n}\n</code></pre><h4 id=\"u6279_u91CF_u64CD_u4F5C_uFF0C_u4EE5_u6362_u884C_u7B26_u6765_u5224_u65AD_uFF0C_u9632_u6B62_u4E0D_u5FC5_u8981_u7684json_u89E3_u6790_u7B49_u6570_u636E_u62F7_u8D1D_u3002\"><a href=\"#u6279_u91CF_u64CD_u4F5C_uFF0C_u4EE5_u6362_u884C_u7B26_u6765_u5224_u65AD_uFF0C_u9632_u6B62_u4E0D_u5FC5_u8981_u7684json_u89E3_u6790_u7B49_u6570_u636E_u62F7_u8D1D_u3002\" class=\"headerlink\" title=\"批量操作，以换行符来判断，防止不必要的json解析等数据拷贝。\"></a>批量操作，以换行符来判断，防止不必要的json解析等数据拷贝。</h4><pre><code>POST /_bulk\n{ action: {metadata }} \\n\n{ request body } \\n\n{ action: {metadata }} \\n\n{ request body } \\n\n</code></pre>"}